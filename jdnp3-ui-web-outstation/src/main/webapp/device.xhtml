<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui"
	xmlns:j="http://sf.net/jdnp3/facelets"
	xmlns:jdnp3="http://java.sun.com/jsf/composite/jdnp3">
<h:head>
	<h:outputScript library="js" name="schedule.js" />
	<h:outputScript library="js" name="analog.js" />
	<h:outputScript library="js" name="binary.js" />
	<h:outputScript library="js" name="iin.js" />
	<h:outputScript library="js" name="main.js" />
	<title>${param['stationCode']} - ${param['deviceCode']}</title>
</h:head>

<h:body>
	<f:facet name="last">
		<h:outputStylesheet library="css" name="general.css" />
	</f:facet>

	<f:view>
		<h:form>
			<p:poll listener="#{jsfKeepAlive.keepUserSessionAlive()}" interval="#{(session.maxInactiveInterval - 10)/3}" />
			
			<p:selectOneMenu id="station" value="#{uiStations.station}" style="width:150px">
				<p:ajax update="device" />
				<f:selectItem itemLabel="Select Station" itemValue="" noSelectionOption="true" />
				<f:selectItems value="#{uiStations.stations}" />
			</p:selectOneMenu>
 
			<p:selectOneMenu  id="device" value="#{uiStations.device}" style="width:150px">
				<p:ajax listener="#{uiStations.submit}" />
				<f:selectItem itemLabel="Select Device" itemValue="" noSelectionOption="true" />
				<f:selectItems value="#{uiStations.devices}" />
			</p:selectOneMenu>
		</h:form>

		<c:if test="#{uiPointDatabase.extsts(param['stationCode'], param['deviceCode'])}">
			<h:form>
				<p:outputPanel id="page">
					<div style="text-align: center; display: block;">
						<p:panel header="Internal Indicators">
							<p:panelGrid style="margin: auto; text-align: right;" columns="2">
								<jdnp3:internalIndicators id="iin" index="0" />
							</p:panelGrid>
						</p:panel>
					</div>
					<c:if test="#{uiPointDatabase.getBinaryInputDataPoints(param['stationCode'], param['deviceCode']).size() > 0}">
						<div style="text-align: center; display: inline-block;">
							<p:panel header="Binary Input">
								<p:panelGrid style="margin: auto; text-align: right;" columns="2">
									<c:forEach var="point" items="#{uiPointDatabase.getBinaryInputDataPoints(param['stationCode'], param['deviceCode'])}">
										<h:outputText style="margin-right: 10px" value="#{point.name} (#{point.index})" /><jdnp3:binaryInput point="#{point}" />
									</c:forEach>
								</p:panelGrid>
							</p:panel>
						</div>
					</c:if>
					<c:if test="#{uiPointDatabase.getBinaryOutputDataPoints(param['stationCode'], param['deviceCode']).size() > 0}">
						<div style="text-align: center; display: inline-block;">
							<p:panel header="Binary Output">
								<p:panelGrid style="margin: auto; text-align: right;" columns="2">
									<c:forEach var="point" items="#{uiPointDatabase.getBinaryOutputDataPoints(param['stationCode'], param['deviceCode'])}">
										<h:outputText style="margin-right: 10px" value="#{point.name} (#{point.index})" /><jdnp3:binaryOutput point="#{point}" />
									</c:forEach>
								</p:panelGrid>
							</p:panel>
						</div>
					</c:if>
					<c:if test="#{uiPointDatabase.getAnalogInputDataPoints(param['stationCode'], param['deviceCode']).size() > 0}">
						<div style="text-align: center; display: inline-block;">
							<p:panel header="Analog Input">
								<p:panelGrid style="margin: auto; text-align: right;" columns="2">
									<c:forEach var="point" items="#{uiPointDatabase.getAnalogInputDataPoints(param['stationCode'], param['deviceCode'])}">
										<h:outputText style="margin-right: 10px" value="#{point.name} (#{point.index})" /><jdnp3:analogInput point="#{point}" />
									</c:forEach>
								</p:panelGrid>
							</p:panel>
						</div>
					</c:if>
					<c:if test="#{uiPointDatabase.getAnalogOutputDataPoints(param['stationCode'], param['deviceCode']).size() > 0}">
						<div style="text-align: center; display: inline-block;">
							<p:panel header="Analog Output">
								<p:panelGrid style="margin: auto; text-align: right;" columns="2">
									<c:forEach var="point" items="#{uiPointDatabase.getAnalogOutputDataPoints(param['stationCode'], param['deviceCode'])}">
										<h:outputText style="margin-right: 10px" value="#{point.name} (#{point.index})" /><jdnp3:analogOutput point="#{point}" />
									</c:forEach>
								</p:panelGrid>
							</p:panel>
						</div>
					</c:if>
				</p:outputPanel>
			</h:form>
		</c:if>

		<c:if test="#{not uiPointDatabase.extsts(param['stationCode'], param['deviceCode'])}">
			<p:outputPanel id="page">
				<div style="text-align: center; display: block;">
					<h:outputText style="font-size: 24px" value="Device '${param['stationCode']}:${param['deviceCode']}' does not exist." />
				</div>
			</p:outputPanel>
		</c:if>
	</f:view>
</h:body>
</html>